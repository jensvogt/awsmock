//
// Created by vogje01 on 02/06/2023.
//

#ifndef AWMOCK_CORE_JWT_UTILS_TEST_H
#define AWMOCK_CORE_JWT_UTILS_TEST_H

// GTest includes
#include <gtest/gtest.h>

// Poco includes
#include <Poco/Path.h>

// Local includes
#include <awsmock/core/JwtUtils.h>

std::string publicKey = R"(-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuGbXWiK3dQTyCbX5xdE4
yCuYp0AF2d15Qq1JSXT/lx8CEcXb9RbDddl8jGDv+spi5qPa8qEHiK7FwV2KpRE9
83wGPnYsAm9BxLFb4YrLYcDFOIGULuk2FtrPS512Qea1bXASuvYXEpQNpGbnTGVs
WXI9C+yjHztqyL2h8P6mlThPY9E9ue2fCqdgixfTFIF9Dm4SLHbphUS2iw7w1JgT
69s7of9+I9l5lsJ9cozf1rxrXX4V1u/SotUuNB3Fp8oB4C1fLBEhSlMcUJirz1E8
AziMCxS+VrRPDM+zfvpIJg3JljAh3PJHDiLu902v9w+Iplu1WyoB2aPfitxEhRN0
YwIDAQAB
-----END PUBLIC KEY-----)";
std::string privateKey = R"(-----BEGIN PRIVATE KEY-----
MIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQC4ZtdaIrd1BPIJ
tfnF0TjIK5inQAXZ3XlCrUlJdP+XHwIRxdv1FsN12XyMYO/6ymLmo9ryoQeIrsXB
XYqlET3zfAY+diwCb0HEsVvhisthwMU4gZQu6TYW2s9LnXZB5rVtcBK69hcSlA2k
ZudMZWxZcj0L7KMfO2rIvaHw/qaVOE9j0T257Z8Kp2CLF9MUgX0ObhIsdumFRLaL
DvDUmBPr2zuh/34j2XmWwn1yjN/WvGtdfhXW79Ki1S40HcWnygHgLV8sESFKUxxQ
mKvPUTwDOIwLFL5WtE8Mz7N++kgmDcmWMCHc8kcOIu73Ta/3D4imW7VbKgHZo9+K
3ESFE3RjAgMBAAECggEBAJTEIyjMqUT24G2FKiS1TiHvShBkTlQdoR5xvpZMlYbN
tVWxUmrAGqCQ/TIjYnfpnzCDMLhdwT48Ab6mQJw69MfiXwc1PvwX1e9hRscGul36
ryGPKIVQEBsQG/zc4/L2tZe8ut+qeaK7XuYrPp8bk/X1e9qK5m7j+JpKosNSLgJj
NIbYsBkG2Mlq671irKYj2hVZeaBQmWmZxK4fw0Istz2WfN5nUKUeJhTwpR+JLUg4
ELYYoB7EO0Cej9UBG30hbgu4RyXA+VbptJ+H042K5QJROUbtnLWuuWosZ5ATldwO
u03dIXL0SH0ao5NcWBzxU4F2sBXZRGP2x/jiSLHcqoECgYEA4qD7mXQpu1b8XO8U
6abpKloJCatSAHzjgdR2eRDRx5PMvloipfwqA77pnbjTUFajqWQgOXsDTCjcdQui
wf5XAaWu+TeAVTytLQbSiTsBhrnoqVrr3RoyDQmdnwHT8aCMouOgcC5thP9vQ8Us
rVdjvRRbnJpg3BeSNimH+u9AHgsCgYEA0EzcbOltCWPHRAY7B3Ge/AKBjBQr86Kv
TdpTlxePBDVIlH+BM6oct2gaSZZoHbqPjbq5v7yf0fKVcXE4bSVgqfDJ/sZQu9Lp
PTeV7wkk0OsAMKk7QukEpPno5q6tOTNnFecpUhVLLlqbfqkB2baYYwLJR3IRzboJ
FQbLY93E8gkCgYB+zlC5VlQbbNqcLXJoImqItgQkkuW5PCgYdwcrSov2ve5r/Acz
FNt1aRdSlx4176R3nXyibQA1Vw+ztiUFowiP9WLoM3PtPZwwe4bGHmwGNHPIfwVG
m+exf9XgKKespYbLhc45tuC08DATnXoYK7O1EnUINSFJRS8cezSI5eHcbQKBgQDC
PgqHXZ2aVftqCc1eAaxaIRQhRmY+CgUjumaczRFGwVFveP9I6Gdi+Kca3DE3F9Pq
PKgejo0SwP5vDT+rOGHN14bmGJUMsX9i4MTmZUZ5s8s3lXh3ysfT+GAhTd6nKrIE
kM3Nh6HWFhROptfc6BNusRh1kX/cspDplK5x8EpJ0QKBgQDWFg6S2je0KtbV5PYe
RultUEe2C0jYMDQx+JYxbPmtcopvZQrFEur3WKVuLy5UAy7EBvwMnZwIG7OOohJb
vkSpADK6VPn9lbqq7O8cTedEHttm6otmLt8ZyEl3hZMaL3hbuRj6ysjmoFKx6CrX
rK0/Ikt5ybqUzKCMJZg2VKGTxg==
-----END PRIVATE KEY-----)";
/*
AccessToken.
eyJraWQiOiJnNU05ajFIbnpUSVVabWU0QU4rd0JWaTBWYzhvUzZ6SjNHblIxdnF0YytJPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiIzMDVlZWM3OS0zY2IxLTQ3ZmUtOTk3ZS03MWQ3ZTFkOWYxZWMiLCJjb2duaXRvOmdyb3VwcyI6WyJldS1jZW50cmFsLTFfWHpFV2M0N2I2X1dpbmRvd3MiXSwiaXNzIjoiaHR0cHM6XC9cL2NvZ25pdG8taWRwLmV1LWNlbnRyYWwtMS5hbWF6b25hd3MuY29tXC9ldS1jZW50cmFsLTFfWHpFV2M0N2I2IiwidmVyc2lvbiI6MiwiY2xpZW50X2lkIjoiMXJnZHE1ZHUzczBoa2g1bDE2cmFycGo2bWMiLCJvcmlnaW5fanRpIjoiZWQ1Y2NmZGYtODE2Ny00YjQ3LTkyNzQtMGQ4OWZjZWFlNjYxIiwidG9rZW5fdXNlIjoiYWNjZXNzIiwic2NvcGUiOiJhd3MuY29nbml0by5zaWduaW4udXNlci5hZG1pbiBvcGVuaWQgcHJvZmlsZSBlbWFpbCIsImF1dGhfdGltZSI6MTcyMzkxMjQ1MywiZXhwIjoxNzIzOTE2MDUzLCJpYXQiOjE3MjM5MTI0NTMsImp0aSI6ImQxODBkOGM2LWJiMjQtNDFiZS1hZTZiLTU5ZGNhN2ZkZTU4MyIsInVzZXJuYW1lIjoiV2luZG93c19KZW5zLlZvZ3RAb3BpdHotY29uc3VsdGluZy5jb20ifQ.ihQfeXyz5moV9GmGom_N_KBgfyVWMyxh6Rd2-T8t2hP1N1SmOIzgw2QfZGQCsXrh65p6JAR4-1IZtu8pgX836cri4FNhXx45lnbDqEjNa3zzT6CbUoCcEUQHngnbFiDFyy4ucshjSZxCoxE3NHHFEoUxu2pFRkOT8lBXkrkmD3-3eRpr1hOXA0p2uN7AlgKXgDVZOQ22Pwk8MeYeY7Y8eSjlzkz_8nHaVbd-TkIAdzU_u9ryshMYj9S76SRdfRSc3ebyHYqdkaS50c0YRU1sZ1vMh8dmW3C6xGj1SWBpWRtvWOCF4nvLzRvPdBy72twAYxQURWIK3rgeHZxT8aqS9A
IDToken
eyJraWQiOiI5XC9YNFg3d09WOExvV1g2WndaVlhZQWc5YUNuZ21XRFhaNWxDYlM2ck5ucz0iLCJhbGciOiJSUzI1NiJ9.eyJhdF9oYXNoIjoiRi1DZmxxNmlNZmxSQ01UMzdmVGdCQSIsInN1YiI6IjMwNWVlYzc5LTNjYjEtNDdmZS05OTdlLTcxZDdlMWQ5ZjFlYyIsImNvZ25pdG86Z3JvdXBzIjpbImV1LWNlbnRyYWwtMV9YekVXYzQ3YjZfV2luZG93cyJdLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC5ldS1jZW50cmFsLTEuYW1hem9uYXdzLmNvbVwvZXUtY2VudHJhbC0xX1h6RVdjNDdiNiIsImNvZ25pdG86dXNlcm5hbWUiOiJXaW5kb3dzX0plbnMuVm9ndEBvcGl0ei1jb25zdWx0aW5nLmNvbSIsIm5vbmNlIjoiTnpwMjZZRUkwZDZtV0k4TmtnU0RadWZuZDF4eUN6a2xIOVhpbVBOVGg5aEJ6bzB1OGN4dUNISUxIbGlVa1lnRm5tTVNPeDFwU19vUWo2YU5zOEM4WncyelhTMk9zUUQ5VmVaX2E2RnZxNHpBX29jRmxkQndLUTRvSmZQbFA3eVRyRlFKMEJsdE1uMGNlVnFJTlZDMkY0NWtVQXEwQzlxX3IybWRDa3g4VUtNIiwiY3VzdG9tOmdyb3VwcyI6IltMaWJyaW9uZS1ub24tcHJvZC1leHQtZGV2ZWxvcGVyLCBMaWJyaS5PbmUtUHJvZC1BZG1pbi1FeHRlcm4tRGV2ZWxvcGVyXSIsIm9yaWdpbl9qdGkiOiJlZDVjY2ZkZi04MTY3LTRiNDctOTI3NC0wZDg5ZmNlYWU2NjEiLCJhdWQiOiIxcmdkcTVkdTNzMGhraDVsMTZyYXJwajZtYyIsImlkZW50aXRpZXMiOlt7InVzZXJJZCI6IkplbnMuVm9ndEBvcGl0ei1jb25zdWx0aW5nLmNvbSIsInByb3ZpZGVyTmFtZSI6IldpbmRvd3MiLCJwcm92aWRlclR5cGUiOiJTQU1MIiwiaXNzdWVyIjoiaHR0cHM6XC9cL3N0cy53aW5kb3dzLm5ldFwvYTY1OWM3NWYtZGM3YS00N2M0LWFkNmUtZmEzMjA1YzRkMTc3XC8iLCJwcmltYXJ5IjoidHJ1ZSIsImRhdGVDcmVhdGVkIjoiMTY1MDYxMTkyMTE3MyJ9XSwidG9rZW5fdXNlIjoiaWQiLCJhdXRoX3RpbWUiOjE3MjM5MTI0NTMsIm5hbWUiOiJKZW5zLlZvZ3RAb3BpdHotY29uc3VsdGluZy5jb20iLCJjdXN0b206Y29tcGFueU5hbWUiOiJPUElUWiBDT05TVUxUSU5HIERldXRzY2hsYW5kIEdtYkgiLCJleHAiOjE3MjM5MTYwNTMsImlhdCI6MTcyMzkxMjQ1MywianRpIjoiYWZlYjQwZjYtYmViYS00MzdjLTkwY2UtZDdhZmNmOTBkZWZkIiwiZW1haWwiOiJKZW5zLlZvZ3RAb3BpdHotY29uc3VsdGluZy5jb20ifQ.H1MWELPWndJep9chSVWpqL8jlBgIRbnkX4rsS2hUlDM9JQyjFy58Md4CWPutKM3aLP4beh3XZWPqqQ7tBLccM32NVrUPpWL84pbKOIpfYfZf88ZX-OXYmt-CCk49fXRdx-dijztgwi_QcOqgaH2tpZoL0_mC8Y4fR9s5xnhIbyRdsQfm8SfRUmg3z_rVzQv78V3e6ON5zA5gM6FNJssOmpCkDzYQ63l1tmF1vld8WqQ6jzPHUOtJg4eyzP_W-wqIvOj6ADdB3MR1u1UYqOQjsHJRsoQRzdMp3-wY0lCMWlahUkEVHq1md9IorwMVMRjVNkhR0TyUQmPExCbuBaXu4g
RefreshToken
eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAifQ.pLkHLyI-h4fH4Qk_1dCpBx3knEtf1hC__q-xboCbxvtCOyupzlEfhZjABHH43Rg2NRtIgI-VQhqv8kXk3b89FcaeANZfHuUnZL7sjgzjITIBYQACxefICVz91Qi_WwEczqTJizHEekQksy_vWsffy4WxTRUgznYFOEuoQXma93dhrpSWWSwb8Ve9qPObUXuhEeyWt25_3bFf0-svFo6GBOgA8jJ1DxYbeMjAl6C2Hk1QwbtAgSCmZ-ZoKAdsq84AVqicFGZEt2vHiWtMiV2n5VQejztmQUFVXIMV7a2wjJERPG6CAXoEYux19RmFWIKPq0fYaKT6w1IBaIEKx9wSqw.yBPlYKOT5Tuy2Hv9.Ci2NIqngs7YDdkRgaRHMhHs7aWG29Gx5pkHmPxWjCK3esITKDBjfUASbrshemY_F_WoD-gm9SxLpngxtZN_nlN996B8rylKXAU-KgvNVa6htcQ0_AV9_il7-KbzqKiNUGRXpqQsqSjnPUz8K9aepvA-waCLY-Qibm3IRE13JkZJRGLUixF-uEYUa0x1KSErtJMBCkhYjTBxLbK2TxUq2AnWdpznvjikP6J2Deun2fcyyOH6wwoyWAIvwTcR0DlTGOBJsB6-J33gw6MzIEpp_bpClkLMxLgOWpqN-JNHk9vxX1XLYmrrNKosRXvJIBWx3RjLGyHXx0xMzTna2486c79vXahRCCHT1nXQ2bRrg7So18CEjPSwO-Gvrz6R8hFiWmtwRoVlnSe6acYmjnateWOPlDYD-Pt7y86v9TvVCnziMjpfQuo_GdEdPcWi5itKcchdf2fBRZEHDPRyppfHsY5-92EUW7qhfi1Ydewf-E6EmRX-PNHG2htHLlF2TWzdWojITJmiVTSyrWIQiECtre3wLc83WAliRL0UpGNiu7Qg8ywE1jM_qaaysnQrVTmHBF9uMg4ryB8JRdrpqGIkrLT8ZbyzEhGrKlChdZyM64FuQk76NONWF8PVBrw6Rcl3ccswBXR6JDz8Ca83mEXO_zFUhL8z5LtMMm2gwEa0IJqq4_2M7lMwWnjIGSbUb5g9AEJks7RT6GPnqzXwCvOCqJgKGjeTtpK0f2X56UZXdF-Me7rxJUdET5dHXvbHWb3Vbsyssd7a_uieKNEerPnBehMIhPgJTBnA03W2t-X839I1B93WI7oVzpPLOKZXBZMUEVT4LtrPLGh59PESjwIJySbLTgHgTJu_Zp7icKNuSf7nN0Q7MqL2yQxMah4tXXmQhLiesb-vUs4PgwUpb0PyowNM6o4i5PrmRPplgoi4yRNduTbf2h2ngyJzikgGOJBiEqCxcxeeAFNioPHnF2BOhofovAHmLmHj2-rn1V3YiITl4uUB9pJqe2msAOqO_VkwB-7UaxRTAluUQYdc0uXLctZZ-WYnQTC6GC3P2NNFq7W33ZRNLpmSKq6HYUOMp2Vw6t7cScPEnUCsta-NmGf73KHqUx1s4cMqis4B6O82FLVaTQ0BW_lnTQM-jursDmdfJ5u2GyLEtd16etJsryUTWKlamFzNPpg49B856wiviq0T3cV1taqClsL3cCYbH2bOUiOHMclXNZkHOMen6gB_CNjubC5LjPt5hVtVTwrCCStcsNoa0xR2AXVxgPGNKcPzwx1c1bSVrP2x8p9fQPpcopyDf6HFeu5TKsSE4eKJ16CE.kKs5kNgDS4SOXD0PiWWqog
userdata
{
    "UserAttributes":[
        {"Name":"sub","Value":"305eec79-3cb1-47fe-997e-71d7e1d9f1ec"},
        {"Name":"identities","Value":"[{\"userId\":\"Jens.Vogt@opitz-consulting.com\",\"providerName\":\"Windows\",\"providerType\":\"SAML\",\"issuer\":\"https://sts.windows.net/a659c75f-dc7a-47c4-ad6e-fa3205c4d177/\",\"primary\":true, \"dateCreated\":1650611921173}]"},
        {"Name":"email_verified","Value":"false"},
        {"Name":"name","Value":"Jens.Vogt@opitz-consulting.com"},{"Name":"custom:companyName","Value":"OPITZ CONSULTING Deutschland GmbH"},
        {"Name":"email","Value":"Jens.Vogt@opitz-consulting.com"},{"Name":"custom:groups","Value":"[Librione-non-prod-ext-developer, Libri.One-Prod-Admin-Extern-Developer]"}
    ],
    "Username":"Windows_Jens.Vogt@opitz-consulting.com"
}
client-secret: 17h3m30d3rdj7bvtug33amrte5aud5nkv9nsf89n2sltk815hnfl
accessToken:"eyJraWQiOiJnNU05ajFIbnpUSVVabWU0QU4rd0JWaTBWYzhvUzZ6SjNHblIxdnF0YytJPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiIzMDVlZWM3OS0zY2IxLTQ3ZmUtOTk3ZS03MWQ3ZTFkOWYxZWMiLCJjb2duaXRvOmdyb3VwcyI6WyJldS1jZW50cmFsLTFfWHpFV2M0N2I2X1dpbmRvd3MiXSwiaXNzIjoiaHR0cHM6XC9cL2NvZ25pdG8taWRwLmV1LWNlbnRyYWwtMS5hbWF6b25hd3MuY29tXC9ldS1jZW50cmFsLTFfWHpFV2M0N2I2IiwidmVyc2lvbiI6MiwiY2xpZW50X2lkIjoiMXJnZHE1ZHUzczBoa2g1bDE2cmFycGo2bWMiLCJvcmlnaW5fanRpIjoiZWQ1Y2NmZGYtODE2Ny00YjQ3LTkyNzQtMGQ4OWZjZWFlNjYxIiwidG9rZW5fdXNlIjoiYWNjZXNzIiwic2NvcGUiOiJhd3MuY29nbml0by5zaWduaW4udXNlci5hZG1pbiBvcGVuaWQgcHJvZmlsZSBlbWFpbCIsImF1dGhfdGltZSI6MTcyMzkxMjQ1MywiZXhwIjoxNzIzOTE2MDUzLCJpYXQiOjE3MjM5MTI0NTMsImp0aSI6ImQxODBkOGM2LWJiMjQtNDFiZS1hZTZiLTU5ZGNhN2ZkZTU4MyIsInVzZXJuYW1lIjoiV2luZG93c19KZW5zLlZvZ3RAb3BpdHotY29uc3VsdGluZy5jb20ifQ.ihQfeXyz5moV9GmGom_N_KBgfyVWMyxh6Rd2-T8t2hP1N1SmOIzgw2QfZGQCsXrh65p6JAR4-1IZtu8pgX836cri4FNhXx45lnbDqEjNa3zzT6CbUoCcEUQHngnbFiDFyy4ucshjSZxCoxE3NHHFEoUxu2pFRkOT8lBXkrkmD3-3eRpr1hOXA0p2uN7AlgKXgDVZOQ22Pwk8MeYeY7Y8eSjlzkz_8nHaVbd-TkIAdzU_u9ryshMYj9S76SRdfRSc3ebyHYqdkaS50c0YRU1sZ1vMh8dmW3C6xGj1SWBpWRtvWOCF4nvLzRvPdBy72twAYxQURWIK3rgeHZxT8aqS9A"
    clientId:"1rgdq5du3s0hkh5l16rarpj6mc"
    idToken:"eyJraWQiOiI5XC9YNFg3d09WOExvV1g2WndaVlhZQWc5YUNuZ21XRFhaNWxDYlM2ck5ucz0iLCJhbGciOiJSUzI1NiJ9.eyJhdF9oYXNoIjoiRi1DZmxxNmlNZmxSQ01UMzdmVGdCQSIsInN1YiI6IjMwNWVlYzc5LTNjYjEtNDdmZS05OTdlLTcxZDdlMWQ5ZjFlYyIsImNvZ25pdG86Z3JvdXBzIjpbImV1LWNlbnRyYWwtMV9YekVXYzQ3YjZfV2luZG93cyJdLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC5ldS1jZW50cmFsLTEuYW1hem9uYXdzLmNvbVwvZXUtY2VudHJhbC0xX1h6RVdjNDdiNiIsImNvZ25pdG86dXNlcm5hbWUiOiJXaW5kb3dzX0plbnMuVm9ndEBvcGl0ei1jb25zdWx0aW5nLmNvbSIsIm5vbmNlIjoiTnpwMjZZRUkwZDZtV0k4TmtnU0RadWZuZDF4eUN6a2xIOVhpbVBOVGg5aEJ6bzB1OGN4dUNISUxIbGlVa1lnRm5tTVNPeDFwU19vUWo2YU5zOEM4WncyelhTMk9zUUQ5VmVaX2E2RnZxNHpBX29jRmxkQndLUTRvSmZQbFA3eVRyRlFKMEJsdE1uMGNlVnFJTlZDMkY0NWtVQXEwQzlxX3IybWRDa3g4VUtNIiwiY3VzdG9tOmdyb3VwcyI6IltMaWJyaW9uZS1ub24tcHJvZC1leHQtZGV2ZWxvcGVyLCBMaWJyaS5PbmUtUHJvZC1BZG1pbi1FeHRlcm4tRGV2ZWxvcGVyXSIsIm9yaWdpbl9qdGkiOiJlZDVjY2ZkZi04MTY3LTRiNDctOTI3NC0wZDg5ZmNlYWU2NjEiLCJhdWQiOiIxcmdkcTVkdTNzMGhraDVsMTZyYXJwajZtYyIsImlkZW50aXRpZXMiOlt7InVzZXJJZCI6IkplbnMuVm9ndEBvcGl0ei1jb25zdWx0aW5nLmNvbSIsInByb3ZpZGVyTmFtZSI6IldpbmRvd3MiLCJwcm92aWRlclR5cGUiOiJTQU1MIiwiaXNzdWVyIjoiaHR0cHM6XC9cL3N0cy53aW5kb3dzLm5ldFwvYTY1OWM3NWYtZGM3YS00N2M0LWFkNmUtZmEzMjA1YzRkMTc3XC8iLCJwcmltYXJ5IjoidHJ1ZSIsImRhdGVDcmVhdGVkIjoiMTY1MDYxMTkyMTE3MyJ9XSwidG9rZW5fdXNlIjoiaWQiLCJhdXRoX3RpbWUiOjE3MjM5MTI0NTMsIm5hbWUiOiJKZW5zLlZvZ3RAb3BpdHotY29uc3VsdGluZy5jb20iLCJjdXN0b206Y29tcGFueU5hbWUiOiJPUElUWiBDT05TVUxUSU5HIERldXRzY2hsYW5kIEdtYkgiLCJleHAiOjE3MjM5MTYwNTMsImlhdCI6MTcyMzkxMjQ1MywianRpIjoiYWZlYjQwZjYtYmViYS00MzdjLTkwY2UtZDdhZmNmOTBkZWZkIiwiZW1haWwiOiJKZW5zLlZvZ3RAb3BpdHotY29uc3VsdGluZy5jb20ifQ.H1MWELPWndJep9chSVWpqL8jlBgIRbnkX4rsS2hUlDM9JQyjFy58Md4CWPutKM3aLP4beh3XZWPqqQ7tBLccM32NVrUPpWL84pbKOIpfYfZf88ZX-OXYmt-CCk49fXRdx-dijztgwi_QcOqgaH2tpZoL0_mC8Y4fR9s5xnhIbyRdsQfm8SfRUmg3z_rVzQv78V3e6ON5zA5gM6FNJssOmpCkDzYQ63l1tmF1vld8WqQ6jzPHUOtJg4eyzP_W-wqIvOj6ADdB3MR1u1UYqOQjsHJRsoQRzdMp3-wY0lCMWlahUkEVHq1md9IorwMVMRjVNkhR0TyUQmPExCbuBaXu4g"
    refreshToken:"eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAifQ.pLkHLyI-h4fH4Qk_1dCpBx3knEtf1hC__q-xboCbxvtCOyupzlEfhZjABHH43Rg2NRtIgI-VQhqv8kXk3b89FcaeANZfHuUnZL7sjgzjITIBYQACxefICVz91Qi_WwEczqTJizHEekQksy_vWsffy4WxTRUgznYFOEuoQXma93dhrpSWWSwb8Ve9qPObUXuhEeyWt25_3bFf0-svFo6GBOgA8jJ1DxYbeMjAl6C2Hk1QwbtAgSCmZ-ZoKAdsq84AVqicFGZEt2vHiWtMiV2n5VQejztmQUFVXIMV7a2wjJERPG6CAXoEYux19RmFWIKPq0fYaKT6w1IBaIEKx9wSqw.yBPlYKOT5Tuy2Hv9.Ci2NIqngs7YDdkRgaRHMhHs7aWG29Gx5pkHmPxWjCK3esITKDBjfUASbrshemY_F_WoD-gm9SxLpngxtZN_nlN996B8rylKXAU-KgvNVa6htcQ0_AV9_il7-KbzqKiNUGRXpqQsqSjnPUz8K9aepvA-waCLY-Qibm3IRE13JkZJRGLUixF-uEYUa0x1KSErtJMBCkhYjTBxLbK2TxUq2AnWdpznvjikP6J2Deun2fcyyOH6wwoyWAIvwTcR0DlTGOBJsB6-J33gw6MzIEpp_bpClkLMxLgOWpqN-JNHk9vxX1XLYmrrNKosRXvJIBWx3RjLGyHXx0xMzTna2486c79vXahRCCHT1nXQ2bRrg7So18CEjPSwO-Gvrz6R8hFiWmtwRoVlnSe6acYmjnateWOPlDYD-Pt7y86v9TvVCnziMjpfQuo_GdEdPcWi5itKcchdf2fBRZEHDPRyppfHsY5-92EUW7qhfi1Ydewf-E6EmRX-PNHG2htHLlF2TWzdWojITJmiVTSyrWIQiECtre3wLc83WAliRL0UpGNiu7Qg8ywE1jM_qaaysnQrVTmHBF9uMg4ryB8JRdrpqGIkrLT8ZbyzEhGrKlChdZyM64FuQk76NONWF8PVBrw6Rcl3ccswBXR6JDz8Ca83mEXO_zFUhL8z5LtMMm2gwEa0IJqq4_2M7lMwWnjIGSbUb5g9AEJks7RT6GPnqzXwCvOCqJgKGjeTtpK0f2X56UZXdF-Me7rxJUdET5dHXvbHWb3Vbsyssd7a_uieKNEerPnBehMIhPgJTBnA03W2t-X839I1B93WI7oVzpPLOKZXBZMUEVT4LtrPLGh59PESjwIJySbLTgHgTJu_Zp7icKNuSf7nN0Q7MqL2yQxMah4tXXmQhLiesb-vUs4PgwUpb0PyowNM6o4i5PrmRPplgoi4yRNduTbf2h2ngyJzikgGOJBiEqCxcxeeAFNioPHnF2BOhofovAHmLmHj2-rn1V3YiITl4uUB9pJqe2msAOqO_VkwB-7UaxRTAluUQYdc0uXLctZZ-WYnQTC6GC3P2NNFq7W33ZRNLpmSKq6HYUOMp2Vw6t7cScPEnUCsta-NmGf73KHqUx1s4cMqis4B6O82FLVaTQ0BW_lnTQM-jursDmdfJ5u2GyLEtd16etJsryUTWKlamFzNPpg49B856wiviq0T3cV1taqClsL3cCYbH2bOUiOHMclXNZkHOMen6gB_CNjubC5LjPt5hVtVTwrCCStcsNoa0xR2AXVxgPGNKcPzwx1c1bSVrP2x8p9fQPpcopyDf6HFeu5TKsSE4eKJ16CE.kKs5kNgDS4SOXD0PiWWqog"
 */
namespace AwsMock::Core {

    class JwtUtilsTest : public ::testing::Test {};

    TEST_F(JwtUtilsTest, TokenCreateTest) {

        // arrange
        std::map<std::string, std::string> payload;
        payload["first1"] = "second1";
        payload["first2"] = "second2";

        // act
        std::string result = JwtUtils::CreateTokenRs256(privateKey, "auth0", payload);

        // assert
        EXPECT_FALSE(result.empty());
    }

    TEST_F(JwtUtilsTest, TokenVerifyTest) {

        // arrange
        std::map<std::string, std::string> payload;
        payload["first1"] = "second1";
        payload["first2"] = "second2";
        std::string createResult = JwtUtils::CreateTokenRs256(privateKey, "auth0", payload);
        EXPECT_FALSE(createResult.empty());

        // act
        bool result = JwtUtils::VerifyTokenRs256(publicKey, createResult, "auth0");

        // assert
        EXPECT_TRUE(result);
    }

}// namespace AwsMock::Core

#endif// AWMOCK_CORE_JWT_UTILS_TEST_H